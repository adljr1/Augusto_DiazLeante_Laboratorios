-- Q1
SELECT COUNT( DISTINCT last_name) AS Unique_Last_Names
FROM actor;

-- Q2
SELECT  COUNT(DISTINCT language_id) AS Unique_Language
FROM film;

-- Q3
SELECT COUNT(rating) AS 'PG-13 Count'
FROM film
WHERE rating = 'PG-13';


-- Q4
SELECT title, length 
FROM film
WHERE release_year = 2006
ORDER BY length DESC
LIMIT 10;

-- Q5
SELECT  DATEDIFF(MAX(rental_date),MIN(rental_date))
FROM rental;

-- Q6
SELECT *, 
       MONTH(rental_date)   AS rental_month,
       DAYNAME(rental_date) AS rental_weekday
FROM rental
LIMIT 20;

-- Q7
SELECT *,
       CASE
           WHEN WEEKDAY(rental_date) < 5 THEN 'workday'
           ELSE 'weekend'
       END AS day_type
FROM rental;

-- Q8
SELECT COUNT(rental_date)
FROM rental
WHERE MONTH(return_date) = MONTH((SELECT MAX(return_date) FROM rental));

-- Q9
SELECT COUNT(*), c.name AS 'Category Name'
FROM film_category f
JOIN category c ON f.category_id = c.category_id
GROUP BY f.category_id;

-- Q10
SELECT SUM(amount), c.first_name
FROM payment p
JOIN customer c ON c.customer_Id= p.customer_Id
GROUP BY c.customer_Id;

-- Q11
SELECT COUNT(*), release_year
FROM film
GROUP BY release_year; 

-- Q12
SELECT COUNT(actor_id), film_Id
FROM film_actor
GROUP BY film_id;

-- Q13
SELECT AVG(amount)
FROM payment
GROUP BY staff_id;

-- Q14
SELECT category_id, COUNT(*)
FROM film_category
GROUP BY category_id
HAVING COUNT(*) > 10;

-- Q15
SELECT customer_id, COUNT(*)
FROM payment
GROUP BY customer_id
HAVING COUNT(*) > 5;

-- Q16
SELECT YEAR(payment_date), COUNT(*)
FROM payment
GROUP BY YEAR(payment_date)
HAVING AVG(amount) > 20;

-- Q17
SELECT film_id, COUNT(*)
FROM film_actor
GROUP BY film_id
HAVING COUNT(*) > 3;

-- Q18
SELECT f.title, c.name
FROM film_category fc
JOIN film f ON f.film_id = fc.film_id
JOIN category c ON c.category_id = fc.category_id;

-- Q19
SELECT DISTINCT release_year 
FROM film;

-- Q20
SELECT title 
FROM film
WHERE (title LIKE '%ARMAGEDDON%');

-- Q21
SELECT title 
FROM film
WHERE (title LIKE '%APOLLO%');

-- Q22
SELECT title 
FROM film
WHERE (title LIKE '%APOLLO');

-- Q23
SELECT title 
FROM film
WHERE (title LIKE '%DATE%');

-- Q24
SELECT title 
FROM film
ORDER BY LENGTH(title) DESC
LIMIT 10;

-- Q25
SELECT title 
FROM film
ORDER BY length DESC
LIMIT 10;

-- Q26
SELECT title, special_features
FROM film
WHERE (special_features LIKE '%Behind%');

-- Q27
SELECT title , release_year
FROM film
ORDER BY release_year DESC, title ASC ;


